<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title>PEG</title>
  <meta name="CreationTime" content="2021-03-19T18:52:59Z">
  <meta name="ModificationTime" content="2021-03-19T18:52:59Z">
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1894.6">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px Palatino}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px Palatino; min-height: 18.0px}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; text-indent: 18.0px; font: 13.0px Palatino; min-height: 18.0px}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; text-indent: 18.0px; font: 13.0px Palatino}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    li.li1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px Palatino}
    span.s1 {font: 13.0px Palatino}
    table.t1 {border-collapse: collapse}
    td.td1 {border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #000000 #000000 #000000 #000000; padding: 0.0px 5.0px 0.0px 5.0px}
    td.td2 {border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #bfbfbf #bfbfbf #bfbfbf #bfbfbf; padding: 0.0px 5.0px 0.0px 5.0px}
    ul.ul1 {list-style-type: disc}
  </style>
</head>
<body>
<div style="width: 600px; margin: 0 auto">

<table cellspacing="0" cellpadding="0" class="t1">
  <tbody>
    <tr>
      <td valign="top" class="td1">
        <p class="p1">REGEX</p>
      </td>
      <td valign="top" class="td1">
        <p class="p1">PEG (Ohm-JS)</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">Racket (#lang peg)</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p2"><br></p>
      </td>
    </tr>
    <tr>
      <td valign="top" class="td1">
        <p class="p1">/a/</p>
      </td>
      <td valign="top" class="td1">
        <p class="p1">"a"</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">'a'</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p2"><br></p>
      </td>
    </tr>
    <tr>
      <td valign="middle" class="td2">
        <p class="p1">/abc/</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">"abc"</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">'abc'</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p2"><br></p>
      </td>
    </tr>
    <tr>
      <td valign="middle" class="td2">
        <p class="p1">/a*/</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">"a" *</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">'a' *</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">0 or more</p>
      </td>
    </tr>
    <tr>
      <td valign="middle" class="td2">
        <p class="p1">/a?/</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">"a"?</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">'a'?</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">optional (0<span class="Apple-converted-space">  </span>or 1)</p>
      </td>
    </tr>
    <tr>
      <td valign="middle" class="td2">
        <p class="p1">/a+/</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">"a"+</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">'a'+</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">1 or more</p>
      </td>
    </tr>
    <tr>
      <td valign="middle" class="td2">
        <p class="p1">/(a)(bc)/</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">("a") ("bc")</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">('a') ('bc')</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">grouping / memo</p>
      </td>
    </tr>
    <tr>
      <td valign="middle" class="td2">
        <p class="p1">\1\2</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1"><i>rule</i>:<i> </i>function (v1, v2) { … }</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">v1:('a') v2:('bc')</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">naming matches</p>
      </td>
    </tr>
    <tr>
      <td valign="middle" class="td2">
        <p class="p1">/[a-z]/</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">"a" .. "z"</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">[a-z]</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">character class</p>
      </td>
    </tr>
    <tr>
      <td valign="middle" class="td2">
        <p class="p1">/./</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">any</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">.</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">any</p>
      </td>
    </tr>
    <tr>
      <td valign="middle" class="td2">
        <p class="p1">/(a|b|c)/</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">"a" | "b" | "c"</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">('a' / 'b' / 'c')</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">alternates (original thesis used "/")</p>
      </td>
    </tr>
    <tr>
      <td valign="middle" class="td2">
        <p class="p2"><br></p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">"a" rule</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">v1:('a') v2:rule</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">call rule (in context)</p>
      </td>
    </tr>
    <tr>
      <td valign="middle" class="td2">
        <p class="p2"><br></p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">!"a"</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">~'a'</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">not</p>
      </td>
    </tr>
    <tr>
      <td valign="middle" class="td2">
        <p class="p2"><br></p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">rule = …</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">rule &lt;— … ;</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">define callable rule</p>
      </td>
    </tr>
    <tr>
      <td valign="middle" class="td2">
        <p class="p2"><br></p>
      </td>
      <td valign="middle" class="td2">
        <p class="p2"><br></p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">_</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">whitespace (convention)</p>
      </td>
    </tr>
    <tr>
      <td valign="middle" class="td2">
        <p class="p2"><br></p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">&amp;"a"</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p2"><br></p>
      </td>
      <td valign="middle" class="td2">
        <p class="p2"><br></p>
      </td>
    </tr>
    <tr>
      <td valign="middle" class="td2">
        <p class="p2"><br></p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">addOperation ('…',{ …})</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">-&gt; <i>lisp</i></p>
      </td>
      <td valign="middle" class="td2">
        <p class="p2"><br></p>
      </td>
    </tr>
    <tr>
      <td valign="middle" class="td2">
        <p class="p2"><br></p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">"{" … "{" … "}" … "}"</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">'{' … '{' … '}' … '}'</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p1">nesting</p>
      </td>
    </tr>
    <tr>
      <td valign="middle" class="td2">
        <p class="p2"><br></p>
      </td>
      <td valign="middle" class="td2">
        <p class="p2"><br></p>
      </td>
      <td valign="middle" class="td2">
        <p class="p2"><br></p>
      </td>
      <td valign="middle" class="td2">
        <p class="p2"><br></p>
      </td>
    </tr>
  </tbody>
</table>
<p class="p3"><br></p>
<p class="p4">The most interesting differences between PEG and REGEX are</p>
<ul class="ul1">
  <li class="li1">not</li>
  <li class="li1">nested rules</li>
</ul>
<p class="p2"><br></p>
<p class="p1">The most interesting difference between Racket #lang peg and Ohm-JS is in the naming of matches.<span class="Apple-converted-space">  </span>In Racket (most PEGs) matches are explicitly tagged with variable names in the PEG grammar.<span class="Apple-converted-space">  </span>In Ohm, all matches are tagged as parameters to rules in the semantics section.</p>
<p class="p2"><br></p>
<p class="p1">[<i>In my opinion, the Ohm idea is better.<span class="Apple-converted-space">  </span>It leaves the grammar intact and more readable.<span class="Apple-converted-space">  </span>One of the problems with REGEX syntax is that it has collected noise over the years, making it even less readable than it originally was.</i>]</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<h2 style="margin: 13.0px 0.0px 0.0px 0.0px; font: 13.0px Palatino"><b>PEG vs. YACC</b></h2>
<p class="p3"><br></p>
<p class="p4">YACC was built from LR(k) theory.<span class="Apple-converted-space">  </span>It matches CFG languages.</p>
<p class="p3"><br></p>
<p class="p4">PEG builds recursive-descent parsers.</p>
<p class="p3"><br></p>
<p class="p4">PEG can match balanced brackets.<span class="Apple-converted-space">  </span>YACC cannot.</p>
<p class="p3"><br></p>
<p class="p4">YACC is theoretically "more sound".</p>
<p class="p3"><br></p>
<p class="p4">PEG is more practical.</p>
<p class="p3"><br></p>
<p class="p4">The main breakthrough in PEG was the idea of using backtracking during the pattern matching.<span class="Apple-converted-space">  </span>This used to be a <i>verbotten</i> concept in the late 1900's, but with advances in hardware, the use of backtracking has become practical.</p>
<p class="p3"><br></p>
<p class="p4">REGEX is also based on theory and is also "sound".</p>
<p class="p3"><br></p>
<p class="p4">YACC and REGEX produce state machines.</p>
<p class="p3"><br></p>
<p class="p4">PEG produces a TDPL (top down parser, recursive descent).</p>
<p class="p3"><br></p>
<h2 style="margin: 13.0px 0.0px 0.0px 0.0px; font: 13.0px Palatino"><b>Pattern Macthing DSLs</b></h2>
<p class="p2"><br></p>
<p class="p1">REGEX and PEG are DSLs for pattern matching.</p>
<p class="p2"><br></p>
<p class="p1">There is little reason to use REGEX instead of PEG, if both are equally available.</p>
<p class="p2"><br></p>
<p class="p1">For simple, one-line matches, REGEX might be preferred because</p>
<ul class="ul1">
  <li class="li1">it is available in many tools (e.g. sed, awk)</li>
  <li class="li1">it is available in many languages (e.g. JavaScript)</li>
  <li class="li1">it has a more succinct syntax for small matches.</li>
</ul>
<p class="p2"><br></p>
<p class="p1">REGEX syntax often results in unreadable patterns.</p>
<p class="p2"><br></p>
<p class="p1">REGEX cannot match nested constructs,<a id="fnlink1"></a><a href="#fn1"><sup>[1]</sup></a> for example when matching text in programming languages.</p>
<p class="p2"><br></p>
<p class="p1">PEG rules are like multiple REGEX patterns that can call each other.<span class="Apple-converted-space">  </span>If only one rule is required, REGEX might be a good choice.</p>
<p class="p2"><br></p>
<p class="p1">In general, though, it is better to use PEG, which allows for later expansion.<span class="Apple-converted-space">  </span>When REGEX is grown through maintenance and fixing edge-cases, it usually results in unreadable code.</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<h2 style="margin: 13.0px 0.0px 0.0px 0.0px; font: 13.0px Palatino"><b>Racket PEG Documentation</b></h2>
<p class="p3"><br></p>
<p class="p4">https://docs.racket-lang.org/peg/index.html</p>
<p class="p3"><br></p>
<h2 style="margin: 13.0px 0.0px 0.0px 0.0px; font: 13.0px Palatino"><b>Ohm-JS PEG Documentation</b></h2>
<p class="p3"><br></p>
<p class="p4"><a href="https://github.com/harc/ohm">https://github.com/harc/ohm</a></p>
<p class="p3"><br></p>
<p class="p3"><br></p>
<h2 style="margin: 13.0px 0.0px 0.0px 0.0px; font: 13.0px Palatino"><b>PEG Thesis</b></h2>
<p class="p3"><br></p>
<p class="p4">You don't need to read this …</p>
<p class="p3"><br></p>
<p class="p4"><a href="https://bford.info/pub/lang/peg.pdf">https://bford.info/pub/lang/peg.pdf</a></p>
<p class="p3"><br></p>
<p class="p6"><br></p>
<hr>
<p class="p7"><a id="fn1"></a><a href="#fnlink1"><span class="s1">[1]</span></a><span class="s1"> </span>REGEX probably can be made to match nested constructs, but requires more effort.</p>
</div>
</body>
</html>
